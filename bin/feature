#!/bin/bash

# root path project
__root="$(cd "$(dirname "$(dirname "${BASH_SOURCE[0]}")")" && pwd)"

# defaults
admin="ADMIN=''"
admin_level="municipios"
tolerance="TOLERANCE=''"
file="${__root}/config/geojson.sql"

# parse arguments
while true
do
  case $1 in
    -a|--admin)
      admin="ADMIN='"$2"'"
      if [ "${2,,}" == "ccaa" ]; then
        admin_level="ccaa"
      elif [ "${2,,}" == "prov" ]; then
        admin_level="prov"
      fi
      shift 2
      ;;
    -t|--tolerance)
      tolerance="TOLERANCE='"$2"'"
      shift 2
      ;;
    *)
      break
  esac
done

output="${__root}/features/${admin_level}/feature.geojson"

# execute the runner with a preset of parameters
"$(dirname "$0")"/runner "--variable=${admin}|--variable=${tolerance}|--tuples-only|--file=${file}" "${output}" "$@"

exit $?;
